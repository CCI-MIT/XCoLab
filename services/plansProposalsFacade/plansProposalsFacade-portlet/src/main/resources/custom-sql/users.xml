<custom-sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByScreenNameAsc">
        <![CDATA[
			SELECT * FROM User_ as us WHERE us.screenName like ? or us.firstName like ? or us.lastName like ? ORDER BY us.screenName ASC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByScreenNameAscFilteredByCategory">
        <![CDATA[
			SELECT * FROM User_ as us INNER JOIN Users_Roles as ur ON us.userId = ur.userId INNER JOIN xcolab_rolescategory as ro ON ur.roleId = ro.roleId WHERE (us.screenName like ? or us.firstName like ? or us.lastName like ?) AND ro.categoryName = ? ORDER BY us.screenName ASC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByScreenNameDesc">
        <![CDATA[
			SELECT * FROM User_ as us WHERE us.screenName like ? or us.firstName like ? or us.lastName like ? ORDER BY us.screenName DESC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByScreenNameDescFilteredByCategory">
        <![CDATA[
			SELECT * FROM User_ as us INNER JOIN Users_Roles as ur ON us.userId = ur.userId INNER JOIN xcolab_rolescategory as ro ON ur.roleId = ro.roleId WHERE (us.screenName like ? or us.firstName like ? or us.lastName like ?) AND ro.categoryName = ? ORDER BY us.screenName DESC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByRoleNameAsc">
        <![CDATA[
			SELECT  u.*, r.*
FROM User_ u
    INNER JOIN
    (
        SELECT ur.userId, MAX(roleOrdinal) roleOrdinal
        FROM Users_Roles ur
	INNER JOIN xcolab_rolescategory r
ON ur.roleId = r.roleId
        GROUP BY ur.userId
    ) b ON u.userId = b.userId
INNER JOIN xcolab_rolescategory r
ON r.roleOrdinal = b.roleOrdinal
WHERE u.screenName like ? or u.firstName like ? or u.lastName like ?
ORDER BY r.categoryName ASC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByRoleNameDesc">
        <![CDATA[
			SELECT  u.*, r.*
FROM User_ u
    INNER JOIN
    (
        SELECT ur.userId, MAX(roleOrdinal) roleOrdinal
        FROM Users_Roles ur
	INNER JOIN xcolab_rolescategory r
ON ur.roleId = r.roleId
        GROUP BY ur.userId
    ) b ON u.userId = b.userId
INNER JOIN xcolab_rolescategory r
ON r.roleOrdinal = b.roleOrdinal
WHERE u.screenName like ? or u.firstName like ? or u.lastName like ?
ORDER BY r.categoryName DESC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByMemberSinceAsc">
        <![CDATA[
			SELECT * FROM User_ as us WHERE us.screenName like ? or us.firstName like ? or us.lastName like ? ORDER BY us.createDate ASC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByMemberSinceAscFilteredByCategory">
        <![CDATA[
			SELECT * FROM User_ as us INNER JOIN Users_Roles as ur ON us.userId = ur.userId INNER JOIN xcolab_rolescategory as ro ON ur.roleId = ro.roleId WHERE (us.screenName like ? or us.firstName like ? or us.lastName like ?) AND ro.categoryName = ? ORDER BY us.createDate ASC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByMemberSinceDesc">
        <![CDATA[
			SELECT * FROM User_ as us WHERE us.screenName like ? or us.firstName like ? or us.lastName like ? ORDER BY us.createDate DESC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByMemberSinceDescFilteredByCategory">
        <![CDATA[
			SELECT * FROM User_ as us INNER JOIN Users_Roles as ur ON us.userId = ur.userId INNER JOIN xcolab_rolescategory as ro ON ur.roleId = ro.roleId WHERE (us.screenName like ? or us.firstName like ? or us.lastName like ?) AND ro.categoryName = ? ORDER BY us.createDate DESC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByActivityCountAsc">
        <![CDATA[
			SELECT *, us.userId as uId, (SELECT COUNT(*) FROM SocialActivity WHERE SocialActivity.userId = uId) as activityCount FROM User_ as us WHERE us.screenName like ? or us.firstName like ? or us.lastName like ? ORDER BY activityCount ASC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByActivityCountAscFilteredByCategory">
        <![CDATA[
			SELECT *, us.userId as uId, (SELECT COUNT(*) FROM SocialActivity WHERE SocialActivity.userId = uId) as activityCount FROM User_ as us INNER JOIN Users_Roles as ur ON us.userId = ur.userId INNER JOIN xcolab_rolescategory as ro ON ur.roleId = ro.roleId WHERE (us.screenName like ? or us.firstName like ? or us.lastName like ?) AND ro.categoryName = ? ORDER BY activityCount ASC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByActivityCountDesc">
        <![CDATA[
			SELECT *, us.userId as uId, (SELECT COUNT(*) FROM SocialActivity WHERE SocialActivity.userId = uId) as activityCount FROM User_ as us WHERE us.screenName like ? or us.firstName like ? or us.lastName like ? ORDER BY activityCount DESC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUsersSortedByActivityCountDescFilteredByCategory">
        <![CDATA[
			SELECT *, us.userId as uId, (SELECT COUNT(*) FROM SocialActivity WHERE SocialActivity.userId = uId) as activityCount FROM User_ as us INNER JOIN Users_Roles as ur ON us.userId = ur.userId INNER JOIN xcolab_rolescategory as ro ON ur.roleId = ro.roleId WHERE (us.screenName like ? or us.firstName like ? or us.lastName like ?) AND ro.categoryName = ? ORDER BY activityCount DESC
		]]>
    </sql>

    <sql id="com.ext.portlet.service.persistence.User_Finder.getUserActivityCount">
        <![CDATA[
			SELECT COUNT(*) FROM SocialActivity WHERE SocialActivity.userId = ?
		]]>
    </sql>

</custom-sql>