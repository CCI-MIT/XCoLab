<?xml version="1.0"?>
<!--
  ~ Copyright (c) 2010. M.I.T. All Rights Reserved
  ~ Licensed under the MIT license. Please see http://www.opensource.org/licenses/mit-license.php
  ~ or the license.txt file included in this distribution for the full text of the license.
  -->

<f:view
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:fn="http://java.sun.com/jsp/jstl/functions"   
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:collab="http://climatecollaboratorium.org/facelets"
        xmlns:sharedcollab="http://climatecollaboratorium.org/components">
        
  <div class="contestsContainer">
<ice:form>
    <div class="blueheaderbar tooltips">
        <div class="contest">
            <ice:commandLink actionListener="#{contests.changeSortColumn}" value="Contest" >
                <f:attribute name="sortColumn" value="CONTEST_NAME" />
            </ice:commandLink>
            <div class="tooltip">click to sort by contest title<div class="tt-arrow"></div></div>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{contests.sortColumn}" />
                <ui:param name="currentColumn" value="CONTEST_NAME" />
                <ui:param name="sortAscending" value="#{contests.sortAscending}" />
             </ui:include>
        
        </div>
        <div class="proposal">
        
            <ice:commandLink actionListener="#{contests.changeSortColumn}" value=" ">
                <f:attribute name="sortColumn" value="PROPOSALS" />
            </ice:commandLink>
            <div class="tooltip">click to sort by<br />number of proposals<div class="tt-arrow"></div></div>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{contests.sortColumn}" />
                <ui:param name="currentColumn" value="PROPOSALS" />
                <ui:param name="sortAscending" value="#{contests.sortAscending}" />
             </ui:include>
        </div>
        
        <div class="comment">
            <ice:commandLink actionListener="#{contests.changeSortColumn}" value=" " >
                <f:attribute name="sortColumn" value="COMMENTS" />
            </ice:commandLink>
            <div class="tooltip">click to sort by number of comments<div class="tt-arrow"></div></div>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{contests.sortColumn}" />
                <ui:param name="currentColumn" value="COMMENTS" />
                <ui:param name="sortAscending" value="#{contests.sortAscending}" />
             </ui:include>
        </div>
        <div class="what">
            <ice:commandLink actionListener="#{contests.changeSortColumn}" value="What" >
                <f:attribute name="sortColumn" value="WHAT" />
            </ice:commandLink>
            <div class="tooltip">click to sort by actions<div class="tt-arrow"></div></div>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{contests.sortColumn}" />
                <ui:param name="currentColumn" value="WHAT" />
                <ui:param name="sortAscending" value="#{contests.sortAscending}" />
             </ui:include>
        </div>
        <div class="where">
            <ice:commandLink actionListener="#{contests.changeSortColumn}" value="Where" >
                <f:attribute name="sortColumn" value="WHERE" />
            </ice:commandLink>
            <div class="tooltip">click to sort by<br />geographical area<div class="tt-arrow"></div></div>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{contests.sortColumn}" />
                <ui:param name="currentColumn" value="WHERE" />
                <ui:param name="sortAscending" value="#{contests.sortAscending}" />
             </ui:include>
        </div>
        <div class="who">
            <ice:commandLink actionListener="#{contests.changeSortColumn}" value="Who">
                <f:attribute name="sortColumn" value="WHO" />
            </ice:commandLink>
            <div class="tooltip">click to sort by who<br />this issue affects<div class="tt-arrow"></div></div>
            <ui:include src="./widget_SORT_ARROW.xhtml">
                <ui:param name="sortColumn" value="#{contests.sortColumn}" />
                <ui:param name="currentColumn" value="WHO" />
                <ui:param name="sortAscending" value="#{contests.sortAscending}" />
             </ui:include>
        
        </div>
    </div>
    <div class="shadebar"></div>
    
    <f:subview rendered="#{fn:length(contests.contestsFeatured) gt 0}">
        <ui:include src="./widget_CONTESTS_LIST_SINGLE.xhtml">
            <ui:param name="contests" value="#{contests.contestsFeatured}" />
            <ui:param name="cls" value="featured" />
        </ui:include>
    
        <div class="shadebar"></div>
    </f:subview>
    
    <f:subview rendered="#{fn:length(contests.contestsNormal) gt 0}">
        <ui:include src="./widget_CONTESTS_LIST_SINGLE.xhtml">
            <ui:param name="contests" value="#{contests.contestsNormal}" />
            <ui:param name="cls" value="" />
        </ui:include>
    </f:subview>
    <f:subview rendered="#{fn:length(contests.contests) eq 0}">
        <table class="contestlist">
            <tr><td style="text-align: center;">
                Nothing found
            </td></tr>
        </table>
    </f:subview>

    <script type="text/javascript">
        initTooltips();
        jQuery.cookie("cc_contests_viewType", null, {expires: -1});
        jQuery.cookie("cc_contests_viewType", "LIST", {expires: 365, path: '/'});
    </script>
    
</ice:form>
</div>
</f:view>