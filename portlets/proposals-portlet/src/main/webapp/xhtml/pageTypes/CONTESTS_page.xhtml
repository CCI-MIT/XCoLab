<?xml version="1.0"?>
<!--
  ~ Copyright (c) 2010. M.I.T. All Rights Reserved
  ~ Licensed under the MIT license. Please see http://www.opensource.org/licenses/mit-license.php
  ~ or the license.txt file included in this distribution for the full text of the license.
  -->

<f:view
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:collab="http://climatecollaboratorium.org/facelets"
        xmlns:sharedcollab="http://climatecollaboratorium.org/components">

<ice:panelGroup styleClass="hidden" >
  #{contests}
  <script type="text/javascript">
    initializeColumnsInfo();
  </script>
</ice:panelGroup>
<div id="content">
    <div class="headline formmargin">
    
    <h1>Contests</h1>
    <ice:form>
    <div class="view ${contests.viewType.lowerCase}view"> <!-- To switch the button over to list view just change "gridview" to "listview" -->
        <div class="grid">
            <div>
                <f:subview rendered="#{contests.viewType != 'GRID'}">
                    <ice:commandLink actionListener="#{contests.setViewType}" value="Grid View" onclick="jQuery('.contestsContainer').block();">
                        <f:attribute name="viewType" value="GRID" />
                    </ice:commandLink>
                </f:subview>
                <f:subview rendered="#{contests.viewType == 'GRID'}">
                    Grid View
                </f:subview>
            
            </div></div>
        <div class="list">
            <div>
                <f:subview rendered="#{contests.viewType != 'LIST'}">
                    <ice:commandLink actionListener="#{contests.setViewType}" value="List View" onclick="jQuery('.contestsContainer').block();">
                        <f:attribute name="viewType" value="LIST" />
                    </ice:commandLink>
                </f:subview>
                <f:subview rendered="#{contests.viewType == 'LIST'}">
                    <ice:outputText value="List View" />
                </f:subview>
            </div>
        </div>
    </div>
  
  <div class="show">
  <a href="/web/guest/resources/-/wiki/Main/What%2C+Where%2C+Who+taxonomy--Quick+view" >Outline View</a></div>
  <div class="divider"/> 
  <div class="show">
    <f:subview rendered="#{contests.showActiveOnly}"><a href="/web/guest/plans/-/plans/contestsType/prior" >Show prior contests</a></f:subview>
    <f:subview rendered="#{not contests.showActiveOnly}"><a href="/web/guest/plans/" >Show active contests</a></f:subview>
  </div>
  <div class="divider"></div> 
  <div class="show"><a href="javascript:;" onclick="if(!deferUntilLogin()) return false; jQuery('#suggestContestPopupContainer').show();">Suggest a new contest</a></div> 
 <div class="filter" style="position: relative;">
    <input type="text" value="#{contests.filterString}" placeholder="Filter contests" onchange="Collab.nav.navigateAddParams('plans', {contestFilter: this.value}); return false;" />
    <f:subview rendered="#{not empty contests.filterString}">
        <a href="javascript:;" onclick="Collab.nav.navigateAddParams('plans', {contestFilter: ''}); return false;" id="contestsFilterClear">&amp;nbsp;</a>
    </f:subview>
 </div>
    </ice:form><br />
 </div> <!-- /headline -->
    <f:subview value="Show active contests" actionListener="#{contests.toggleActiveInactive}" rendered="#{not contests.showActiveOnly}">
        <ice:form>
            <div id="archivedContestsMarkerContainer">
                <img src="/climatecolab-theme/images/contests-archive.png" />
                <strong>Archived:</strong>You are currently viewing archived contests.&amp;nbsp; <a href="/web/guest/plans" >Back to active contests</a>
            </div>
        </ice:form>
        
    </f:subview>
  
  
  <ui:include src="./contests/#{contests.viewType}_page.xhtml" />
  <ice:form>
  <div id="suggestContestPopupContainer" >
    <div class="popup-wrap p1" id="suggestContestPopup">
        <div class="popup">
            <h4>Please review the &amp;nbsp;<a href='/web/guest/resources/-/wiki/Main/Guidelines+for+suggesting+new+contests' target='_blank'>new contest guidelines</a> and the enter your suggestion below. A message will be sent to the CoLab staff and they will follow up with you soon.</h4>
            <div id="suggestContestPopupContent" class="lrContentPlaceholder lfr-column ">
                <div>
                    <ice:inputTextarea value="#{contests.newContestSuggestion}" style="display: block; width: 100%; height: 80px;"/>
                </div>
                <center>
                <br />
                <div class="blue-button">
                    <ice:commandLink value="Send" actionListener="#{contests.sendContestSuggestion}" />
                </div>
                <div class="blue-button">
                    <a href="javascript:;" onclick="jQuery('#suggestContestPopupContainer').hide();" >Cancel</a>
                </div>
                </center>
            </div>
        </div>
    </div>
  </div>
  
  
    <f:subview rendered="#{contests.contestSuggestionSent}">
        <ice:panelGroup styleClass="hidden" >
           #{contests} #{contests.newContestSuggestion}
            <script type="text/javascript">
                jQuery('#suggestContestPopupContainer').hide();
            </script>
        </ice:panelGroup>
    </f:subview>
    
  </ice:form>
    
    
    
</div>
</f:view>
