<?xml version="1.0"?>
<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:liferay-faces="http://liferay.com/tld/faces"
        xmlns:collab="http://climatecollaboratorium.org/components">
    <div class="plan-model">

        <div id="model-selection" class="hidden">
            <div id="model-selection-popup-content">
                <ice:panelBorder>
                    <f:facet name="west">
                        <select multiple="true" class="availableModels"></select>
                    </f:facet>
                    <f:facet name="center">
                        <div>
                            <h2>
                                <ice:outputText styleClass="model-name"
                                                value="#{planBean.modelBean.currentModel.name}"/>
                            </h2>
                            <hr/>
                            <ice:outputText styleClass="model-description" escape="false">
                                #{planBean.modelBean.currentModel.description}
                            </ice:outputText>
                            <br/><br/>
                            <span class="model-download-link"></span>

                        </div>

                    </f:facet>
                    <f:facet name="south">

                        <ice:panelGrid columns="2" styleClass="dialog-buttons">
                            <ice:commandButton value="Submit" onclick="hideModelSelectionDialog(true);return false;"/>
                            <ice:commandButton value="Cancel" onclick="hideModelSelectionDialog(false);return false;"/>

                        </ice:panelGrid>

                    </f:facet>
                </ice:panelBorder>
            </div>
        </div>


        <div id="model-upload" class="hidden">
            <div id="model-upload-popup-content">
                <div class="upload-info">
                    You can create your own disaggregated model, which we will consider for incorporation. A template
                    with instructions for creating a spreadsheet model is available <a href="http://www.google.com"> here</a>.
                    Once you have completed your model, please email to <a href="mailto:rjl@mit.edu">rjl@mit.edu</a>.
                </div>

                <ice:commandButton style-class="dialog-buttons" value="OK" onclick="hideModelUploadDialog(true);return false;"/>

            </div>
        </div>


        <div class="hidden" id="model-selection-popup"></div>
        <div class="hidden" id="model-upload-popup"></div>

        <table class="modelConfiguration" style="display: none">
            <ui:repeat value="#{planBean.modelBean.availableModels}" var="item">
                <tr>
                    <td class="model-config">
                        <ice:outputText styleClass="id" escape="false" value="#{item.id}"/>
                        <ice:outputText styleClass="name" escape="false" value="#{item.name}"/>
                        <ice:outputText styleClass="description" escape="false" value="#{item.description}"/>
                        <ice:outputText styleClass="link" escape="false" value="#{item.link}"/>
                    </td>
                </tr>
            </ui:repeat>

            <tr>
                <td>
                    <ice:inputText styleClass="model-selected-item"
                                   value="#{planBean.modelBean.selectedId}"></ice:inputText>
                    <ice:commandButton actionListener="#{columnsConfiguration.update}" value="Update"
                                       styleClass='updateModelsSubmit'/>
                    <ice:commandButton actionListener="#{planBean.modelBean.cancelEdit}" value="Cancel"
                                       styleClass='cancelModelsSubmit'/>
                    <ice:commandButton actionListener="#{planBean.modelBean.submit}" value="Submit"
                                       styleClass='submitModelsSubmit'/>


                </td>
            </tr>
        </table>

        <div class="modelUpload" style="display: none">


                     <ice:commandButton styleClass="model-upload-submit"/>
        </div>
        <collab:helpMessage messageId="planModelsHelp" styleClass="planHelp" hideThisMessage="Hide this message">
    Currently the CoLab allows users to use the MIT Composite Model. Users can also add their own models that take into account factors like:
    <ul>
    <li>more detailed geographic disaggregation, and</li>
    <li>adoption of new technologies,</li>
    <li> lifestyle changes. </li>
    </ul>
</collab:helpMessage>
<collab:helpMessageTrigger messageId="planModelsHelp">+show help</collab:helpMessageTrigger>
        <ice:panelGroup rendered="#{planBean.modelBean.selectable}">
        <div class="intro">
            All plans include the <a
                href="/web/guest/models#modelId=783"> MIT Composite Model</a>. You can also select from several
            different disaggregated input configurations, or upload your own model.
        </div>

        <div class="model-selection-info">
            <div class="model-selection-info-header">
                <span class="model-selection-info-header-title">Selected Disaggregation Model:  #{planBean.modelBean.currentModel.name}</span>

                <ice:panelGrid columns="2" styleClass="buttons">
                    <ice:commandButton actionListener="#{planBean.modelBean.startEdit}" value="Select model"
                                       onclick="showModelSelectionPopup('model-selection-popup');"/>
                    <ice:commandButton value="Upload model"
                                       onclick="showModelUploadPopup();"/>
                </ice:panelGrid>
            </div>

            <hr/>
            <div class="detail">
                <ice:outputText escape="false">
                    #{planBean.modelBean.currentModel.description}
                </ice:outputText>
                <br/><br/>
                <ice:outputText rendered="#{planBean.modelBean.currentModel.link ne null}">
                    <a href="#{planBean.modelBean.currentModel.link}">Download spreadsheet</a>
                </ice:outputText>


            </div>
        </div>
        </ice:panelGroup>



        <ice:panelGroup rendered="#{not planBean.modelBean.selectable}">

            <div class="model-name">
            #{planBean.modelBean.currentModel.name}
            </div>
            <ice:panelGroup styleClass="modeldescription">
            <div class="description">
                #{planBean.modelBean.currentModel.description}
            </div>
            <div class="model-link">(<a href="/web/guest/models#modelId=#{planBean.modelBean.currentModel.id}">more info</a>).</div>
            </ice:panelGroup>             

         </ice:panelGroup>

        <script type="text/javascript">
            jQuery(document).ready(function() {
                initModelConfigurationWidget();
            });
        </script>
    </div>

</f:view>