<?xml version="1.0"?>
<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ice="http://www.icesoft.com/icefaces/component"
        xmlns:ace="http://www.icefaces.org/icefaces/components"
        >
<div class="fileUploadContainer">
    <h:form>
        <ace:fileEntry id="profileImage" fileEntryListener="#{currentUser.uploadPortrait}" styleClass="filepc fileUpload" autoUpload="true" >
            <ice:outputStyle href="/css/main.css" />
        </ace:fileEntry><br />
    </h:form>
</div>
<ice:form autocomplete="off">

    <script type="text/javascript" src="/html/js/editor/ckeditor_old/ckeditor.js" ><!-- --></script>
    <div id="main">
        <!-- use these fields to prevent chrome from wrongly filling in country and current password automatically -->
        <input type="text" style="display:none" />
        <input type="password" style="display:none" />
        <ice:panelGroup>
            <div class="comm_member">
                <div class="comm_member-photo">
                    <ice:panelGroup>
                        <f:subview rendered="#{empty currentUser.uploadedFileName}">
                            <img src="#{currentUser.portrait}" width="150" height="150" alt="#{currentUser.screenName}" />
                        </f:subview>
                        <f:subview rendered="#{not empty currentUser.uploadedFileName}">
                            <img src="/userprofile-portlet/showUploadedImg?fileName=#{currentUser.uploadedFileName}" width="150" height="150" alt="#{currentUser.screenName}" />
                        </f:subview>
                    </ice:panelGroup>

                </div>
                <div class="comm_member-info">
                    <h2>Member Profile</h2>

                    <table border="0" cellpadding="0" cellspacing="0" class="colab nlpad">
                        <tr>
                            <td class="b m" width="170">First Name</td>
                            <td>
                                <ice:inputText id="firstName" value="#{currentUser.firstName}" styleClass="profile_input" required="true" partialSubmit="true" /><br />
                                <ice:message for="firstName" styleClass="form_error_message alert alert-error" errorClass="alert alert-error"/>
                            </td>
                        </tr>
                        <tr>
                            <td class="b">Last Name</td>
                            <td>
                                <ice:inputText id="lastName" value="#{currentUser.lastName}" styleClass="profile_input" required="true"  partialSubmit="true"/><br />
                                <ice:message for="lastName" styleClass="form_error_message alert alert-error" errorClass="alert alert-error"/>
                            </td>
                        </tr>
                    </table>

                    <ice:panelGroup styleClass="profile_upload">

                        <!--
                        <input name="filepc" type="file" size="30" id="filepc" onchange="document.getElementById('fakefilepc').value = this.value;"/>
                        <div id="fakeinputfile"><input name="fakefilepc" type="text" id="fakefilepc" /></div>
                         -->
                    </ice:panelGroup>

                    <f:subview rendered="#{not empty currentUser.fileErrorMessage}">
                <span class="iceMsgError portlet-msg-error Error form_error_message alert alert-error">
                    #{currentUser.fileErrorMessage}
                </span>
                    </f:subview>
                    <ice:message for="profileImage" styleClass="form_error_message alert alert-error" errorClass="alert alert-error" />
                </div>
                <div class="clearfix"></div>
            </div>
        </ice:panelGroup>
        <ice:panelGroup>
            <table border="0" cellpadding="0" cellspacing="0" class="colab nlpad">
                <tr>
                    <td class="b m" width="170">Screen Name</td>
                    <td>
                        <ice:inputText id="screenNameMessage" styleClass="profile_input" value="#{currentUser.screenName}" partialSubmit="true" required="true">
                            <f:attribute name="currentUser" value="#{currentUser}"/>
                            <f:validator validatorId="screenNameValidator"/>
                        </ice:inputText><br />
                        <ice:message for="screenNameMessage" styleClass="form_error_message alert alert-error" errorClass="alert alert-error"/>
                    </td></tr>
                <tr><td class="b">Member Since</td><td class="l">
                    <ice:outputText value="#{currentUser.joinDate}" >
                        <f:convertDateTime pattern="MM/dd/yy" locale="en_US" timeZone="America/New_York"/>
                    </ice:outputText>
                </td></tr>
                <tr>
                    <td class="b m">Email</td>
                    <td>
                        <ice:inputText  id="email" styleClass="profile_input" value="#{currentUser.email}" partialSubmit="true">
                            <f:attribute name="currentUser" value="#{currentUser}"/>
                            <f:validator validatorId="emailValidator"/>
                        </ice:inputText><br />
                        <ice:message for="email" styleClass="form_error_message alert alert-error" errorClass="alert alert-error"/>
                    </td>
                </tr>
                <tr>
                    <td class="b m">Country</td>
                    <td>
                        <ice:selectOneMenu id="country" styleClass="profile_input" value="#{currentUser.country}" partialSubmit="true">
                            <f:attribute name="currentUser" value="#{currentUser}"/>
                            <f:selectItem itemValue="" itemLabel="Select country" />
                            <f:selectItem itemValue="Afghanistan"/>
                            <f:selectItem itemValue="Åland Islands"/>
                            <f:selectItem itemValue="Albania"/>
                            <f:selectItem itemValue="Algeria"/>
                            <f:selectItem itemValue="American Samoa"/>
                            <f:selectItem itemValue="Andorra"/>
                            <f:selectItem itemValue="Angola"/>
                            <f:selectItem itemValue="Anguilla"/>
                            <f:selectItem itemValue="Antarctica"/>
                            <f:selectItem itemValue="Antigua and Barbuda"/>
                            <f:selectItem itemValue="Argentina"/>
                            <f:selectItem itemValue="Armenia"/>
                            <f:selectItem itemValue="Aruba"/>
                            <f:selectItem itemValue="Australia"/>
                            <f:selectItem itemValue="Austria"/>
                            <f:selectItem itemValue="Azerbaijan"/>
                            <f:selectItem itemValue="Bahamas"/>
                            <f:selectItem itemValue="Bahrain"/>
                            <f:selectItem itemValue="Bangladesh"/>
                            <f:selectItem itemValue="Barbados"/>
                            <f:selectItem itemValue="Belarus"/>
                            <f:selectItem itemValue="Belgium"/>
                            <f:selectItem itemValue="Belize"/>
                            <f:selectItem itemValue="Benin"/>
                            <f:selectItem itemValue="Bermuda"/>
                            <f:selectItem itemValue="Bhutan"/>
                            <f:selectItem itemValue="Bolivia, Plurinational State of"/>
                            <f:selectItem itemValue="Bonaire, Sint Eustatius and Saba"/>
                            <f:selectItem itemValue="Bosnia and Herzegovina"/>
                            <f:selectItem itemValue="Botswana"/>
                            <f:selectItem itemValue="Bouvet Island"/>
                            <f:selectItem itemValue="Brazil"/>
                            <f:selectItem itemValue="British Indian Ocean Territory"/>
                            <f:selectItem itemValue="Brunei Darussalam"/>
                            <f:selectItem itemValue="Bulgaria"/>
                            <f:selectItem itemValue="Burkina Faso"/>
                            <f:selectItem itemValue="Burundi"/>
                            <f:selectItem itemValue="Cambodia"/>
                            <f:selectItem itemValue="Cameroon"/>
                            <f:selectItem itemValue="Canada"/>
                            <f:selectItem itemValue="Cape Verde"/>
                            <f:selectItem itemValue="Cayman Islands"/>
                            <f:selectItem itemValue="Central African Republic"/>
                            <f:selectItem itemValue="Chad"/>
                            <f:selectItem itemValue="Chile"/>
                            <f:selectItem itemValue="China"/>
                            <f:selectItem itemValue="Christmas Island"/>
                            <f:selectItem itemValue="Cocos (Keeling) Islands"/>
                            <f:selectItem itemValue="Colombia"/>
                            <f:selectItem itemValue="Comoros"/>
                            <f:selectItem itemValue="Congo"/>
                            <f:selectItem itemValue="Congo, the Democratic Republic of the"/>
                            <f:selectItem itemValue="Cook Islands"/>
                            <f:selectItem itemValue="Costa Rica"/>
                            <f:selectItem itemValue="Côte d'Ivoire"/>
                            <f:selectItem itemValue="Croatia"/>
                            <f:selectItem itemValue="Cuba"/>
                            <f:selectItem itemValue="Curaçao"/>
                            <f:selectItem itemValue="Cyprus"/>
                            <f:selectItem itemValue="Czech Republic"/>
                            <f:selectItem itemValue="Denmark"/>
                            <f:selectItem itemValue="Djibouti"/>
                            <f:selectItem itemValue="Dominica"/>
                            <f:selectItem itemValue="Dominican Republic"/>
                            <f:selectItem itemValue="Ecuador"/>
                            <f:selectItem itemValue="Egypt"/>
                            <f:selectItem itemValue="El Salvador"/>
                            <f:selectItem itemValue="Equatorial Guinea"/>
                            <f:selectItem itemValue="Eritrea"/>
                            <f:selectItem itemValue="Estonia"/>
                            <f:selectItem itemValue="Ethiopia"/>
                            <f:selectItem itemValue="Falkland Islands (Malvinas)"/>
                            <f:selectItem itemValue="Faroe Islands"/>
                            <f:selectItem itemValue="Fiji"/>
                            <f:selectItem itemValue="Finland"/>
                            <f:selectItem itemValue="France"/>
                            <f:selectItem itemValue="French Guiana"/>
                            <f:selectItem itemValue="French Polynesia"/>
                            <f:selectItem itemValue="French Southern Territories"/>
                            <f:selectItem itemValue="Gabon"/>
                            <f:selectItem itemValue="Gambia"/>
                            <f:selectItem itemValue="Georgia"/>
                            <f:selectItem itemValue="Germany"/>
                            <f:selectItem itemValue="Ghana"/>
                            <f:selectItem itemValue="Gibraltar"/>
                            <f:selectItem itemValue="Greece"/>
                            <f:selectItem itemValue="Greenland"/>
                            <f:selectItem itemValue="Grenada"/>
                            <f:selectItem itemValue="Guadeloupe"/>
                            <f:selectItem itemValue="Guam"/>
                            <f:selectItem itemValue="Guatemala"/>
                            <f:selectItem itemValue="Guernsey"/>
                            <f:selectItem itemValue="Guinea"/>
                            <f:selectItem itemValue="Guinea-Bissau"/>
                            <f:selectItem itemValue="Guyana"/>
                            <f:selectItem itemValue="Haiti"/>
                            <f:selectItem itemValue="Heard Island and McDonald Islands"/>
                            <f:selectItem itemValue="Holy See (Vatican City State)"/>
                            <f:selectItem itemValue="Honduras"/>
                            <f:selectItem itemValue="Hong Kong"/>
                            <f:selectItem itemValue="Hungary"/>
                            <f:selectItem itemValue="Iceland"/>
                            <f:selectItem itemValue="India"/>
                            <f:selectItem itemValue="Indonesia"/>
                            <f:selectItem itemValue="Iran, Islamic Republic of"/>
                            <f:selectItem itemValue="Iraq"/>
                            <f:selectItem itemValue="Ireland"/>
                            <f:selectItem itemValue="Isle of Man"/>
                            <f:selectItem itemValue="Israel"/>
                            <f:selectItem itemValue="Italy"/>
                            <f:selectItem itemValue="Jamaica"/>
                            <f:selectItem itemValue="Japan"/>
                            <f:selectItem itemValue="Jersey"/>
                            <f:selectItem itemValue="Jordan"/>
                            <f:selectItem itemValue="Kazakhstan"/>
                            <f:selectItem itemValue="Kenya"/>
                            <f:selectItem itemValue="Kiribati"/>
                            <f:selectItem itemValue="Korea, Democratic People's Republic of"/>
                            <f:selectItem itemValue="Korea, Republic of"/>
                            <f:selectItem itemValue="Kuwait"/>
                            <f:selectItem itemValue="Kyrgyzstan"/>
                            <f:selectItem itemValue="Lao People's Democratic Republic"/>
                            <f:selectItem itemValue="Latvia"/>
                            <f:selectItem itemValue="Lebanon"/>
                            <f:selectItem itemValue="Lesotho"/>
                            <f:selectItem itemValue="Liberia"/>
                            <f:selectItem itemValue="Libya"/>
                            <f:selectItem itemValue="Liechtenstein"/>
                            <f:selectItem itemValue="Lithuania"/>
                            <f:selectItem itemValue="Luxembourg"/>
                            <f:selectItem itemValue="Macao"/>
                            <f:selectItem itemValue="Macedonia, the former Yugoslav Republic of"/>
                            <f:selectItem itemValue="Madagascar"/>
                            <f:selectItem itemValue="Malawi"/>
                            <f:selectItem itemValue="Malaysia"/>
                            <f:selectItem itemValue="Maldives"/>
                            <f:selectItem itemValue="Mali"/>
                            <f:selectItem itemValue="Malta"/>
                            <f:selectItem itemValue="Marshall Islands"/>
                            <f:selectItem itemValue="Martinique"/>
                            <f:selectItem itemValue="Mauritania"/>
                            <f:selectItem itemValue="Mauritius"/>
                            <f:selectItem itemValue="Mayotte"/>
                            <f:selectItem itemValue="Mexico"/>
                            <f:selectItem itemValue="Micronesia, Federated States of"/>
                            <f:selectItem itemValue="Moldova, Republic of"/>
                            <f:selectItem itemValue="Monaco"/>
                            <f:selectItem itemValue="Mongolia"/>
                            <f:selectItem itemValue="Montenegro"/>
                            <f:selectItem itemValue="Montserrat"/>
                            <f:selectItem itemValue="Morocco"/>
                            <f:selectItem itemValue="Mozambique"/>
                            <f:selectItem itemValue="Myanmar"/>
                            <f:selectItem itemValue="Namibia"/>
                            <f:selectItem itemValue="Nauru"/>
                            <f:selectItem itemValue="Nepal"/>
                            <f:selectItem itemValue="Netherlands"/>
                            <f:selectItem itemValue="New Caledonia"/>
                            <f:selectItem itemValue="New Zealand"/>
                            <f:selectItem itemValue="Nicaragua"/>
                            <f:selectItem itemValue="Niger"/>
                            <f:selectItem itemValue="Nigeria"/>
                            <f:selectItem itemValue="Niue"/>
                            <f:selectItem itemValue="Norfolk Island"/>
                            <f:selectItem itemValue="Northern Mariana Islands"/>
                            <f:selectItem itemValue="Norway"/>
                            <f:selectItem itemValue="Oman"/>
                            <f:selectItem itemValue="Pakistan"/>
                            <f:selectItem itemValue="Palau"/>
                            <f:selectItem itemValue="Palestinian Territory, Occupied"/>
                            <f:selectItem itemValue="Panama"/>
                            <f:selectItem itemValue="Papua New Guinea"/>
                            <f:selectItem itemValue="Paraguay"/>
                            <f:selectItem itemValue="Peru"/>
                            <f:selectItem itemValue="Philippines"/>
                            <f:selectItem itemValue="Pitcairn"/>
                            <f:selectItem itemValue="Poland"/>
                            <f:selectItem itemValue="Portugal"/>
                            <f:selectItem itemValue="Puerto Rico"/>
                            <f:selectItem itemValue="Qatar"/>
                            <f:selectItem itemValue="Réunion"/>
                            <f:selectItem itemValue="Romania"/>
                            <f:selectItem itemValue="Russian Federation"/>
                            <f:selectItem itemValue="Rwanda"/>
                            <f:selectItem itemValue="Saint Barthélemy"/>
                            <f:selectItem itemValue="Saint Helena, Ascension and Tristan da Cunha"/>
                            <f:selectItem itemValue="Saint Kitts and Nevis"/>
                            <f:selectItem itemValue="Saint Lucia"/>
                            <f:selectItem itemValue="Saint Martin (French part)"/>
                            <f:selectItem itemValue="Saint Pierre and Miquelon"/>
                            <f:selectItem itemValue="Saint Vincent and the Grenadines"/>
                            <f:selectItem itemValue="Samoa"/>
                            <f:selectItem itemValue="San Marino"/>
                            <f:selectItem itemValue="Sao Tome and Principe"/>
                            <f:selectItem itemValue="Saudi Arabia"/>
                            <f:selectItem itemValue="Senegal"/>
                            <f:selectItem itemValue="Serbia"/>
                            <f:selectItem itemValue="Seychelles"/>
                            <f:selectItem itemValue="Sierra Leone"/>
                            <f:selectItem itemValue="Singapore"/>
                            <f:selectItem itemValue="Sint Maarten (Dutch part)"/>
                            <f:selectItem itemValue="Slovakia"/>
                            <f:selectItem itemValue="Slovenia"/>
                            <f:selectItem itemValue="Solomon Islands"/>
                            <f:selectItem itemValue="Somalia"/>
                            <f:selectItem itemValue="South Africa"/>
                            <f:selectItem itemValue="South Georgia and the South Sandwich Islands"/>
                            <f:selectItem itemValue="South Sudan"/>
                            <f:selectItem itemValue="Spain"/>
                            <f:selectItem itemValue="Sri Lanka"/>
                            <f:selectItem itemValue="Sudan"/>
                            <f:selectItem itemValue="Suriname"/>
                            <f:selectItem itemValue="Svalbard and Jan Mayen"/>
                            <f:selectItem itemValue="Swaziland"/>
                            <f:selectItem itemValue="Sweden"/>
                            <f:selectItem itemValue="Switzerland"/>
                            <f:selectItem itemValue="Syrian Arab Republic"/>
                            <f:selectItem itemValue="Taiwan, Province of China"/>
                            <f:selectItem itemValue="Tajikistan"/>
                            <f:selectItem itemValue="Tanzania, United Republic of"/>
                            <f:selectItem itemValue="Thailand"/>
                            <f:selectItem itemValue="Timor-Leste"/>
                            <f:selectItem itemValue="Togo"/>
                            <f:selectItem itemValue="Tokelau"/>
                            <f:selectItem itemValue="Tonga"/>
                            <f:selectItem itemValue="Trinidad and Tobago"/>
                            <f:selectItem itemValue="Tunisia"/>
                            <f:selectItem itemValue="Turkey"/>
                            <f:selectItem itemValue="Turkmenistan"/>
                            <f:selectItem itemValue="Turks and Caicos Islands"/>
                            <f:selectItem itemValue="Tuvalu"/>
                            <f:selectItem itemValue="Uganda"/>
                            <f:selectItem itemValue="Ukraine"/>
                            <f:selectItem itemValue="United Arab Emirates"/>
                            <f:selectItem itemValue="United Kingdom"/>
                            <f:selectItem itemValue="United States"/>
                            <f:selectItem itemValue="United States Minor Outlying Islands"/>
                            <f:selectItem itemValue="Uruguay"/>
                            <f:selectItem itemValue="Uzbekistan"/>
                            <f:selectItem itemValue="Vanuatu"/>
                            <f:selectItem itemValue="Venezuela, Bolivarian Republic of"/>
                            <f:selectItem itemValue="Viet Nam"/>
                            <f:selectItem itemValue="Virgin Islands, British"/>
                            <f:selectItem itemValue="Virgin Islands, U.S."/>
                            <f:selectItem itemValue="Wallis and Futuna"/>
                            <f:selectItem itemValue="Western Sahara"/>
                            <f:selectItem itemValue="Yemen"/>
                            <f:selectItem itemValue="Zambia"/>
                            <f:selectItem itemValue="Zimbabwe"/>
                        </ice:selectOneMenu><br />
                        <ice:message for="country" styleClass="form_error_message alert alert-error" errorClass="alert alert-error"/>
                    </td>
                </tr>
                <tr>
                    <td class="b m">Current password</td>
                    <td>
                        <ice:inputSecret autocomplete="off" id="currentPasswordInput" styleClass="profile_input" value="#{currentUser.currentPassword}">
                            <f:attribute name="currentUser" value="#{currentUser}"/>
                            <f:validator validatorId="userPasswordValidator"/>
                            <f:attribute name="type" value="current" />
                        </ice:inputSecret><br />
                        <ice:message for="currentPasswordInput" styleClass="form_error_message alert alert-error" errorClass="alert alert-error"/>
                    </td>
                </tr>
                <tr>
                    <td class="b m">New password</td>
                    <td>
                        <ice:inputSecret autocomplete="off"  id="newPasswordInput" styleClass="profile_input" value="#{currentUser.newPassword}" >
                            <f:attribute name="currentUser" value="#{currentUser}"/>
                            <f:validator validatorId="userPasswordValidator"/>
                            <f:attribute name="type" value="new" />
                        </ice:inputSecret><br />
                        <ice:message for="newPasswordInput" styleClass="form_error_message alert alert-error" errorClass="alert alert-error"/>
                    </td>
                </tr>
                <tr>
                    <td class="b m">New password retype</td>
                    <td>
                        <ice:inputSecret autocomplete="off"  id="newPasswordRetypeInput" styleClass="profile_input" value="#{currentUser.newPasswordRetype}" >
                            <f:attribute name="currentUser" value="#{currentUser}"/>
                            <f:attribute name="type" value="newRetype" />
                            <f:validator validatorId="userPasswordValidator"/>
                        </ice:inputSecret><br />
                        <ice:message for="newPasswordRetypeInput" styleClass="form_error_message alert alert-error" errorClass="alert alert-error"/>
                    </td>
                </tr>

                <ice:panelGroup rendered="#{currentUser.hasFacebookId}">
                    <tr>
                        <td class="b m">Facebook</td>
                        <td>
                            <div class="blue-button"><ice:commandLink  actionListener="#{userprofileBean.unlinkSSOAccount}" onclick="updateTextarea();" value="Unlink Facebook account"><f:attribute name="accountType" value="FACEBOOK" /> </ice:commandLink></div>
                        </td>
                    </tr>
                </ice:panelGroup>
                <ice:panelGroup rendered="#{currentUser.hasOpenId}">
                    <tr>
                        <td class="b m">Google</td>
                        <td>
                            <div class="blue-button"><ice:commandLink  actionListener="#{userprofileBean.unlinkSSOAccount}" onclick="updateTextarea();" value="Unlink Google account"><f:attribute name="accountType" value="GOOGLE" /> </ice:commandLink></div>
                        </td>
                    </tr>
                </ice:panelGroup>



            </table>

                <div class="profile_about-head">About me</div>
                <ice:panelGroup styleClass="userProfileAbout" >
                    <ice:inputTextarea rows="6" cols="30" styleClass="profile_about ckeditor-placeholder" value="#{currentUser.about}" onblur="return false;" />
                    <script>
                        var data = $('.ckeditor-placeholder').val();
                        function updateTextarea() {
                            for (var instance in CKEDITOR.instances) {
                                CKEDITOR.instances[instance].updateElement();
                            }
                            data = jQuery('.ckeditor-placeholder').val();
                        }

                        function initializeCkeditor() {
                            jQuery('.ckeditor-placeholder').val(data);
                            for (var key in CKEDITOR.instances) {
                                CKEDITOR.instances[key].destroy(true);
                            }

                            $('.ckeditor-placeholder').each(function (idx, val) {
                                var textId = $(this).attr('id');
                                CKEDITOR.replace(textId);
                            });

                            // Editor change callback
                            for (var key in CKEDITOR.instances) {
                                CKEDITOR.instances[key].on('saveSnapshot', function(ev) {
                                    var len = jQuery.trim(strip(ev.editor.getData()).replace(/&amp;lt;[^&gt;]*&gt;/g, "").replace(/\s+/g, " ").length);
                                    validateCharlength( $('[id="'+key+'"]'), len);
                                });
                            }
                        }

                        function strip(html)
                        {
                            var tmp = document.createElement("DIV");
                            tmp.innerHTML = html;
                            return tmp.textContent || tmp.innerText || "";
                        }

                        function validateCharlength(elem, len) {
                            var charCountContainer = elem.parent().find('.inputLimitContainer');

                            var elem = charCountContainer.children('.limit_characterCount');
                            var max = parseInt(charCountContainer.children('.limit_charactersMax').text());
                            if (elem) {
                                if (len > max) {
                                    charCountContainer.addClass('overflow');
                                }
                                else {
                                    charCountContainer.removeClass('overflow');
                                }
                                elem.text(""+len);
                            }
                        }

                        ice.onBeforeSubmit(updateTextarea);
                        ice.onAfterUpdate(initializeCkeditor );

                        initializeCkeditor();

                        $(document).ready(function() {
                            // Editor change callback
                            $('.ckeditor-placeholder').each(function() {
                                // Set initial length
                                var len = jQuery.trim(strip($(this).val()).replace(/&amp;lt;[^&gt;]*&gt;/g, "").replace(/\s+/g, " ").length);
                                validateCharlength( $(this), len);
                            });
                        });


                    </script>
                    <div class="inputLimitContainer" style="margin-bottom: 20px; float:right; ">
                        <span class="limit_characterCount"><!--  --></span>/&#160;
                        <span class="limit_charactersMax">2000</span> characters
                    </div>
                    <div class="clearfix"><!-- --></div>
                </ice:panelGroup>

            <div class="blue-button"><ice:commandLink  actionListener="#{userprofileBean.updateUser}" onclick="updateTextarea();">Save</ice:commandLink></div>
            <div class="blue-button"><a href="/web/guest/member/-/member/userId/#{currentUser.userId}">Cancel</a></div>
            <!-- <input type="reset" name="reset" class="profile_reset" value="CANCEL" />-->

        </ice:panelGroup>
    </div> <!-- /main -->
</ice:form>
<ice:form>
    <div class="right_col v1">
        <div class="comm_rightcol">
            <div class="comm_rightcol-title2">MESSAGE SETTINGS</div>
            <table border="0" cellpadding="0" cellspacing="0" class="colab">
                <tr>
                    <td>
                        <ice:selectBooleanCheckbox styleClass="profile_cbx" value="#{userprofileBean.sendEmailOnMessage}" partialSubmit="true"/>
                    </td>
                    <td class="profile_settings">
                        Send me an email copy of messages I receive.
                    </td>
                </tr>
                <tr>
                    <td>
                        <ice:selectBooleanCheckbox styleClass="profile_cbx" value="#{userprofileBean.sendEmailOnActivity}" partialSubmit="true"/>
                    </td>
                    <td class="profile_settings">
                        Send me an email copy of activities that I'm subscribed to.
                    </td>
                </tr>
                <tr>
                    <td>
                        <ice:selectBooleanCheckbox disabled="#{not userprofileBean.sendEmailOnActivity}" styleClass="profile_cbx" value="#{userprofileBean.sendDailyEmailOnActivity}" partialSubmit="true"/>
                    </td>
                    <td class="profile_settings">
                        Only send me a daily summary of all activities I'm subscribed to
                    </td>
                </tr>
            </table>
            <div class="clearfix"></div>

        </div>


    </div> <!-- /right_col3 -->
</ice:form>

<script>
    $(".fileUpload").change(function() {
        $(this).parents("form").submit();
    });
    var containerOffset = jQuery(".profile_upload").offset();

    jQuery(".fileUpload").offset(containerOffset);

</script>
</f:view>